flowchart LR
    subgraph Input["ðŸ“ User Input"]
        MSG["'I'm feeling anxious about exams'"]
    end
    
    subgraph Stage1["ðŸŽ­ Stage 1: BERT Emotion Detection"]
        BERT[BERT Model\nbhadresh-savani/bert-base-uncased-emotion]
        CLASSIFY[Emotion Classification]
        ENRICH[Metadata Enrichment]
    end
    
    subgraph EmotionOutput["ðŸ“Š Emotion Data"]
        EMO["emotion: fear\nconfidence: 97.4%\ncategory: negative\nseverity: high"]
    end
    
    subgraph Stage2["ðŸ’Š Stage 2: Therapeutic Mapping"]
        LOOKUP[Strategy Lookup]
        STRATEGY["approach: reassurance\ntone: gentle\nfocus: grounding"]
    end
    
    subgraph Stage3["ðŸ“‹ Stage 3: Emotion-Guided Prompting"]
        PROMPT[Prompt Construction]
        CONTEXT[Add User Context]
        INSTRUCT[Therapeutic Instructions]
    end
    
    subgraph LLM["ðŸ¤– Google Gemini"]
        GENERATE[Generate Response]
    end
    
    subgraph Output["ðŸ’¬ Final Response"]
        RESP["'I can hear that exam anxiety\nis weighing on you...\nLet's try some grounding...'"]
    end
    
    MSG --> BERT
    BERT --> CLASSIFY
    CLASSIFY --> ENRICH
    ENRICH --> EMO
    EMO --> LOOKUP
    LOOKUP --> STRATEGY
    STRATEGY --> PROMPT
    EMO --> PROMPT
    PROMPT --> CONTEXT
    CONTEXT --> INSTRUCT
    INSTRUCT --> GENERATE
    GENERATE --> RESP
